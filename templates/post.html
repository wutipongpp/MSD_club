<!doctype html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MSD Club ‚Äî ‡∏î‡∏π‡πÇ‡∏û‡∏™‡∏ï‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="/static/picture/MSD.jpg">
    <link rel="stylesheet" href="/static/css/nav.css">
    <!-- ‡∏ü‡∏≠‡∏ô‡∏ï‡πå -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    
    <style>
    :root{ --red:#c70707; --blue:#2d32c7; --yellow:#FDC500; --bg:#FAFAFA; }
    body{ background:var(--bg); }
    #postImage {
      max-width: 500px;
      max-height: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    </style>
</head>
<body class="flex flex-col min-h-screen text-slate-900 bg-[var(--bg)]">

    <header class="hidden md:block sticky top-0 z-50 border-b text-white"
            style="background:linear-gradient(90deg,var(--red),var(--blue))">
    <div class="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">

        <!-- Logo -->
        <a href="/" class="flex items-center gap-3">
        <span class="w-10 h-10 rounded-xl overflow-hidden">
            <img src="/static/picture/MSD.jpg" class="w-full h-full object-cover">
        </span>
        <div>
            <div class="text-lg font-extrabold tracking-wide">MSD Club</div>
            <div class="text-xs opacity-90">Math ¬∑ Stat ¬∑ Data Science</div>
        </div>
        </a>

        <!-- Menu -->
        <nav class="flex gap-1 items-center relative">

        <a class="px-3 py-2 rounded-lg hover:bg-white/10 " href="/">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>

        <a class="px-3 py-2 rounded-lg hover:bg-white/10" href="/alumni">‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡πÄ‡∏Å‡πà‡∏≤</a>

          <!-- Dropdown -->
        <div class="relative group">
            <button class="px-3 py-2 rounded-lg hover:bg-white/10  flex items-center gap-1">
                ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö MSD ‚ñæ
            </button>

            <div class="absolute left-0 mt-2 w-56 rounded-xl shadow-lg py-2
                        opacity-0 invisible group-hover:visible group-hover:opacity-100 
                        transition-all duration-300 transform group-hover:translate-y-0 -translate-y-2"
                style="
                    background: linear-gradient(100deg, rgba(140, 45, 199, 0.95), rgba(36, 17, 180, 0.95));
                    backdrop-filter: width(80px);
                ">

                <a href="/gallery" 
                class="block px-4 py-2 text-white/90 hover:bg-white/10 hover:text-white rounded-lg transition">
                    üì∏ ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
                </a>

                <a href="/activity_schedule" 
                class="block px-4 py-2 text-white/90 hover:bg-white/10 hover:text-white rounded-lg transition">
                    üóìÔ∏è ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
                </a>

                <div class="border-t border-white/20 my-1"></div>

                <a href="/club_organization_chart" 
                class="block px-4 py-2 text-white/90 hover:bg-white/10 hover:text-white rounded-lg transition">
                    üóìÔ∏è  ‡∏ú‡∏±‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ä‡∏°‡∏£‡∏°
                </a>

            </div>
        </div>

        <a class="px-3 py-2 rounded-lg hover:bg-white/10 bg-white/10" href="/announcements">‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</a>
        </nav>
    </div>
    </header>



        <!-- ===============================
        MOBILE HEADER
================================= -->
<header class="md:hidden sticky top-0 z-50 border-b text-white"
        style="background:linear-gradient(90deg,var(--red),var(--blue))">
    <div class="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">

        <a href="/" class="flex items-center gap-3">
            <span class="w-10 h-10 rounded-xl overflow-hidden shadow-md">
                <img src="/static/picture/MSD.jpg" class="w-full h-full object-cover">
            </span>
            <div>
                <div class="text-lg font-extrabold tracking-wide">MSD Club</div>
                <div class="text-xs opacity-90">Math ¬∑ Stat ¬∑ Data Science</div>
            </div>
        </a>

        <button id="menuBtn"
                class="text-3xl p-2 rounded-lg active:scale-90 
                       hover:bg-white/20 transition">
            ‚ò∞
        </button>
    </div>
</header>

<!-- ===============================
     NEW MOBILE OFFCANVAS MENU
================================= -->
<div id="mobileMenu"
     class="fixed top-0 right-0 w-72 h-full z-[10000]
            translate-x-full transition-transform duration-300
            flex flex-col bg-gradient-to-b 
            from-[var(--red)] to-[var(--blue)]
            text-white shadow-[0_0_30px_rgba(0,0,0,0.45)] md:hidden">

    <button id="closeMenu"
            class="self-end text-4xl px-4 py-3 
                   text-white hover:text-yellow-300 transition">
        &times;
    </button>

    <!-- PROFILE HEADER -->
    <div class="px-6 py-3 mb-3 flex items-center gap-3">
        <span class="w-12 h-12 rounded-xl overflow-hidden shadow-lg border border-white/20">
            <img src="/static/picture/MSD.jpg" class="w-full h-full object-cover">
        </span>
        <div>
            <div class="text-xl font-extrabold drop-shadow">MSD Club Menu</div>
            <div class="text-white/80 text-sm -mt-1">Math ‚Ä¢ Stat ‚Ä¢ Data Science</div>
        </div>
    </div>

    <nav class="flex flex-col gap-2 px-4">

        <a href="/" class="px-3 py-2 rounded-lg hover:bg-white/10">
            üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        </a>

        <a href="/alumni" class="px-3 py-2 rounded-lg hover:bg-white/10">
            üéì ‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡πÄ‡∏Å‡πà‡∏≤
        </a>

        <!-- Dropdown (improved) -->
        <div class="w-full">
            <button class="dropdownBtn w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-white/10 ">
                <span>üìÅ ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö MSD</span>
                <span class="arrow transition-transform">‚ñæ</span>
            </button>

            <div class="dropdownContent max-h-0 overflow-hidden transition-all duration-300 pl-6">
                <a href="/gallery" class="block py-2 hover:text-yellow-300 ">üì∏ ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</a>
                <a href="/activity_schedule" class="block py-2 hover:text-yellow-300">üóìÔ∏è ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</a>
                <a href="/club_organization_chart" class="block py-2 hover:text-yellow-300">üóìÔ∏è ‡∏ú‡∏±‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ä‡∏°‡∏£‡∏°</a>
            </div>
        </div>

        <a href="/announcements" class="px-3 py-2 rounded-lg hover:bg-white/10 bg-white/10">
            üì£ ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
        </a>

    </nav>
</div>

    





    <!-- MAIN CONTENT -->
    <main class="max-w-4xl mx-auto px-4 my-10 flex-1">
    <div id="postBox" class="card overflow-hidden">
      <div id="postImage" class="bg-gray-100 flex items-center justify-center">
        <span class="text-gray-400 text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</span>
      </div>
      <div class="p-6">
        <h1 id="postTitle" class="text-3xl font-extrabold text-blue-950 mb-3">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÇ‡∏û‡∏™‡∏ï‡πå</h1>
        <div id="postContent" class="text-gray-700 leading-relaxed whitespace-pre-line">
          ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÇ‡∏û‡∏™‡∏ï‡πå
        </div>
        <div id="postDate" class="text-xs text-gray-500 mt-4 text-right"></div>
      </div>
    </div>
        <section class="max-w-6xl mx-auto px-4 mt-8 mb-12">
        <h3 class="text-2xl font-extrabold text-blue-950 mb-4 border-b-2 border-blue-200 inline-block pb-1">
            üì∞ ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        </h3>
        <div id="latest" class="grid md:grid-cols-3 gap-6"></div>
        </section>
  </main>

        

    <footer class="mt-auto text-white text-sm"
        style="background:linear-gradient(90deg,var(--blue),var(--red))">
    <div class="max-w-6xl mx-auto px-4 py-6 text-center space-y-3">

        <p class="opacity-90">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏ä‡∏°‡∏£‡∏° MSD ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà</p>

        <!-- Social Icons -->
        <div class="flex justify-center gap-6 text-2xl">
            <a href="https://www.facebook.com/profile.php?id=100095105160653" class="social-icon hover:text-yellow-300 transition" aria-label="Facebook">
                <i class="fa-brands fa-facebook"></i>
            </a>
            <a href="https://www.instagram.com/msd.nu/" class="social-icon hover:text-yellow-300 transition" aria-label="Instagram">
                <i class="fa-brands fa-instagram"></i>
            </a>
            <a href="https://www.tiktok.com/@msd.nu.official?is_from_webapp=1&sender_device=pc" class="social-icon hover:text-yellow-300 transition" aria-label="TikTok">
                <i class="fa-brands fa-tiktok"></i>
            </a>
        </div>

        <div>
            ¬© <span id="y"></span> MSD Club ‚Äî Math ‚Ä¢ Stat ‚Ä¢ Data Science
        </div>
    </div>
</footer>

<script>
    // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    const isAdmin = JSON.parse(localStorage.getItem('msd:isAdmin') || 'false');

    if (isAdmin) {
        // ‡∏´‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏≥‡∏ó‡∏≤‡∏á (navbar)
        const nav = document.querySelector('nav');

        // ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏° "‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô"
        const adminLink = document.createElement('a');
        adminLink.href = "/admin"; // ‚Üê ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        adminLink.textContent = "‚öôÔ∏è ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô";
        adminLink.className = "px-3 py-2 rounded-lg bg-yellow-400 text-blue-950 font-bold hover:bg-yellow-300 transition";

        // ‚úÖ ‡πÅ‡∏ó‡∏£‡∏Å‡πÑ‡∏ß‡πâ‡∏ó‡πâ‡∏≤‡∏¢ nav
        nav.appendChild(adminLink);
    }
</script>

    <script>
  // üß≠ ‡∏î‡∏∂‡∏á ID ‡∏Ç‡∏≠‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏à‡∏≤‡∏Å URL
  const postId = parseInt(window.location.pathname.split('/').pop());
  const postBox = document.getElementById('postBox');
  const imgBox = document.getElementById('postImage');
  const titleEl = document.getElementById('postTitle');
  const contentEl = document.getElementById('postContent');
  const dateEl = document.getElementById('postDate');
  const latest = document.getElementById('latest');

  // üìÖ ‡πÉ‡∏™‡πà‡∏õ‡∏µ footer
  document.getElementById('y').textContent = new Date().getFullYear();

  // üì° ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏à‡∏≤‡∏Å Flask API
  async function loadPost() {
    try {
      const res = await fetch('/api/posts');
      if (!res.ok) throw new Error('‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ');
      const posts = await res.json();

      // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
      const post = posts.find(p => p.id === postId);
      if (!post) {
        postBox.innerHTML = `<div class="p-6 text-center text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏ô‡∏µ‡πâ</div>`;
        return;
      }

      // ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û (auto size)
      imgBox.innerHTML = '';
      if (post.image) {
        const img = new Image();
        img.src = post.image;
        img.className = "w-full h-auto block object-contain rounded-xl";
        imgBox.appendChild(img);
      } else {
        imgBox.innerHTML = `<div class="w-full bg-gray-100 flex items-center justify-center text-gray-400 py-20">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</div>`;
      }

      // ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ / ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ / ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
      titleEl.textContent = post.title || '(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠)';
      contentEl.textContent = post.content || '';
      const date = new Date(post.created_at || post.updated_at);
      dateEl.textContent = `‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠ ${date.toLocaleString('th-TH', { dateStyle: 'long', timeStyle: 'short' })}`;

      // ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ)
      renderLatest(posts.filter(p => p.id !== postId));
    } catch (err) {
      console.error(err);
      postBox.innerHTML = `<div class="p-6 text-center text-red-500">‚ùå ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>`;
    }
  }

  // üì∞ ‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (3 ‡∏≠‡∏±‡∏ô)
  function renderLatest(posts) {
    latest.innerHTML = '';
    if (!posts.length) {
      latest.innerHTML = `<div class="text-gray-500 text-center py-10">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</div>`;
      return;
    }

    posts
      .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
      .slice(0, 3)
      .forEach(p => {
        const wrap = document.createElement('a');
        wrap.href = `/post/${p.id}`;
        wrap.className = `
          group block rounded-2xl overflow-hidden bg-white shadow-md hover:shadow-xl 
          hover:-translate-y-1 border border-gray-200 transition-all duration-300
        `;

        const img = p.image
          ? `<div class="aspect-video relative overflow-hidden">
                <img src="${p.image}" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                <div class="absolute inset-0 bg-black/10 opacity-0 group-hover:opacity-30 transition"></div>
             </div>`
          : `<div class="aspect-video bg-gray-100 flex items-center justify-center text-gray-400">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ</div>`;

        wrap.innerHTML = `
          ${img}
          <div class="p-4">
            <div class="font-semibold text-blue-950 text-lg mb-1 group-hover:text-blue-600 transition">
              ${p.title}
            </div>
            <div class="text-sm text-gray-600 leading-snug">
              ${(p.content || '').slice(0, 90)}${(p.content || '').length > 90 ? '‚Ä¶' : ''}
            </div>
            <div class="mt-3 text-xs text-gray-400 flex items-center gap-1">
              üïì ${new Date(p.created_at).toLocaleDateString('th-TH', { year: 'numeric', month: 'short', day: 'numeric' })}
            </div>
          </div>`;
        latest.appendChild(wrap);
      });
  }

  //  ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°
  document.addEventListener('DOMContentLoaded', loadPost);
</script>
<script src="/static/js/nav.js"></script>
</body>

</body>
</html>
